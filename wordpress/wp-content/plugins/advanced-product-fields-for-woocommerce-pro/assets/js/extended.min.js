!function(){function e(e){for(var t=0,a=["==","!==",">","<","<=",">="],r=0;r<e.length;r++){if(-1<a.indexOf(e[r])&&!t)return{operand:e[r],left:e.substring(0,r).trim(),right:e.substring(r<e.length-1?r+1:r).trim()};"("==e[r]&&t++,")"==e[r]&&t--}return{operand:"=",left:e,right:"true"}}function t(e,t){return"true"===(e=WAPF.Util.parseFx(e,t,!1))||"false"!==e&&(""===e?"":(t=WAPF.Util.evalFx(""+e,!1),isNaN(t)?e:t))}function a(e,a,r,n){switch(e=t(e,n),a=t(a,n),r){case"<":return e>a;case">":return a<e;case">=":return a>=e;case"<=":return e<=a;case"!=":return e!==a;default:return e===a}}var r=WAPF.Util.formulas;function n(e){return e=e.split(/-/g),(e=new Date(new Date(2===e.length?(new Date).getFullYear():parseInt(e[2]),parseInt(e[0])-1,parseInt(e[1])).getTime())).setHours(0,0,0,0),e}function i(e,t){var a=new Date(e.getTime()),r=0,n=0,i=0,d=t.split(" ");if(d.length)for(var l=0;l<d.length;l++){var f=d[l].toLowerCase();-1<f.indexOf("y")&&(r+=parseInt(f.replace("Y",""))),-1<f.indexOf("m")&&(n+=parseInt(f.replace("m",""))),-1<f.indexOf("d")&&(i+=parseInt(f.replace("D","")))}return a.setFullYear(e.getFullYear()+r),a.setMonth(e.getMonth()+n),a.setDate(e.getDate()+i),a}["abs","ceil","sqrt","sin","cos","tan"].forEach(function(e){r[e]=function(t,a){return Math[e](WAPF.Util.parseFx(t[0],a))}}),r.pow=function(e,t){return Math.pow(WAPF.Util.parseFx(e[0],t),WAPF.Util.parseFx(e[1],t))},r.checked=function(e,t){return e=t.find("[data-field-id="+e[0]+"]"),e=WAPF.Util.getFieldValue(e,!0),Array.isArray(e)?e.length:0},r.or=function(t,r){for(var n=0;n<t.length;n++){var i=e(t[n]);if(a(i.left,i.right,i.operand,r))return"true"}return"false"},r.and=function(t,r){for(var n=0;n<t.length;n++){var i=e(t[n]);if(!a(i.left,i.right,i.operand,r))return"false"}return"true"},r.datediff=function(e,t){var a=jQuery("input[data-format]").data("format"),r=dpParseDate(e[0],a);return(dpParseDate(e[1],a).getTime()-r.getTime())/864e4};var d={};WAPF.Filter.add("date/selectable",function(e,t){var a=t.field.data("field-id");if(t.field.data("disable-after")&&t.isToday){var r=t.field.data("disable-after").split(":"),l=new Date((new Date).getTime()+1e4*t.offset);if(l.getHours()>=parseInt(r[0])&&l.getMinutes()>=parseInt(r[1]))return!1}if(void 0!==t.field.data("disabled-days")&&-1<(c=(""+t.field.data("disabled-days")).split(",").map(function(e){return parseInt(e)})).indexOf(t.date.getDay()))return!1;if(t.field.data("min")){var f=null;f=new RegExp("[0-9]{2}-[0-9]{2}([0-9]{4})?").test(t.field.data("min"))?n(t.field.data("min")):i(t.today,t.field.data("min"));if(t.date<f)return!1}if(t.field.data("max")&&(f=null,f=new RegExp("[0-9]{2}-[0-9]{2}([0-9]{4})?").test(t.field.data("max"))?n(t.field.data("max")):i(t.today,t.field.data("max")),t.date>f))return!1;if(t.field.data("disabled-dates")){var u={normal:[],recurring:[]};d[a]?u=d[a]:(t.field.data("disabled-dates").split(",").map(function(e){return e.trim()}).forEach(function(e){var t=2===e.split(/-/g).length?"recuring":"normal";e=n(e);u[t].push(e)}),d[a]=u);for(var s=["normal","recuring"],o=0;o<s.length;o++)for(var g=0;g<u[s[o]].length;g++){var c=u[s[o]][g],p=("recurring"===s[o]?t.date:c).getFullYear();if(t.date.getMonth()===c.getMonth()&&t.date.getFullYear()===p&&t.date.getDate()===c.getDate())return!1}}return e})}();